!function(t,e){function i(t,s){if(this.$element=e(t),this.element=this.$element[0],!this.element instanceof SVGElement)throw new Error("SvgZoom element must be svg");this.$element.data(o)||(this.$element.data(o,this),this.options=e.extend({},i.Defaults,s),this._init())}var o="data.svgzoom",s="http://www.w3.org/2000/svg";i.Defaults={"mouseWheel":!0,"zoomSpeed":.065,"maxZoom":Number.POSITIVE_INFINITY,"minZoom":.5,"initZoom":1,"center":!0,"viewClass":"svgzoom-view","zoomSelector":"","dragCursorStyle":"move","onZoomed":e.noop},i.prototype={"_init":function(){this.isDrag=!1,this.dragStartX=0,this.dragStartY=0,this.state={"x":0,"y":0,"zoom":this.options.initZoom};var t=this.$element.children(this.options.zoomSelector);this.$view=e(document.createElementNS(s,"g")).attr("class",this.options.viewClass),this.view=this.$view.get(0),this.$element.append(this.$view.append(t)),this.update(),this.options.center&&this.center(),this._bind()},"_bind":function(){this.$element.on("mousedown",e.proxy(this._handleMouseDown,this)).on("mouseup",e.proxy(this._handleMouseUp,this)).on("mousemove",e.proxy(this._handleMouseMove,this)).on("mousewheel DOMMouseScroll",e.proxy(this._handleMouseWheel,this)).on("mouseleave",e.proxy(this._handleMouseUp,this))},"_handleMouseDown":function(t){t.preventDefault(),this.isDrag=!0,this.dragStartX=t.clientX,this.dragStartY=t.clientY},"_handleMouseUp":function(t){t.preventDefault(),this.isDrag=!1,this.view.style.cursor=""},"_handleMouseMove":function(t){if(t.preventDefault(),this.isDrag){var e=t.clientX-this.dragStartX,i=t.clientY-this.dragStartY,o=this._getViewBoxScale()/this.state.zoom;this.view.style.cursor=this.options.dragCursorStyle,this.state.x+=e/o,this.state.y+=i/o,this.update()}this.dragStartX=t.clientX,this.dragStartY=t.clientY},"_handleMouseWheel":function(t){var e=this.options,i=t.originalEvent.wheelDelta&&(t.originalEvent.wheelDelta>0?1:-1)||(t.originalEvent.detail>0?-1:1);e.mouseWheel&&this.setZoom(this.state.zoom*(1+e.zoomSpeed*i))},"_getViewBoxScale":function(){return this.viewBoxScale=this.view.getBoundingClientRect().width/this.element.viewBox.baseVal.width},"setZoom":function(t){var e=this.options;t<e.minZoom&&(t=e.minZoom),t>e.maxZoom&&(t=e.maxZoom);var i=this.view.getBoundingClientRect(),o=t-this.state.zoom,s=this._getViewBoxScale();return this.state.zoom=t,this.state.x-=o*i.width/2/s,this.state.y-=o*i.height/2/s,this.update(),this.options.onZoomed.call(this),this},"setMouseWheel":function(t){return this.options.mouseWheel=!!t,this},"center":function(){var t=this.element.getBoundingClientRect(),e=this.view.getBoundingClientRect(),i=this._getViewBoxScale();return this.state.x+=((t.width-e.width)/2-(e.left-t.left))/i,this.state.y+=((t.height-e.height)/2-(e.top-t.top))/i,this.update(),this},"update":function(){var t=this.options;return this.state.zoom<t.minZoom&&(this.state.zoom=t.minZoom),this.state.zoom>t.maxZoom&&(this.state.zoom=t.maxZoom),this.$view.attr("transform","translate("+this.state.x+","+this.state.y+") scale("+this.state.zoom+")"),this}},t.SvgZoom=i}(UCD,jQuery);
